% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rsi_IR.R
\name{rsi}
\alias{rsi}
\title{Calculate resistance of isolates}
\usage{
rsi(ab1, ab2 = NA, interpretation = "IR", minimum = 30,
  as_percent = FALSE, info = FALSE, warning = TRUE)
}
\arguments{
\item{ab1}{vector of antibiotic interpretations, they will be transformed internally with \code{\link{as.rsi}}}

\item{ab2}{like \code{ab}, a vector of antibiotic interpretations. Use this to calculate (the lack of) co-resistance: the probability where one of two drugs have a susceptible result. See Examples.}

\item{interpretation}{antimicrobial interpretation}

\item{minimum}{minimal amount of available isolates. Any number lower than \code{minimum} will return \code{NA}. The default number of \code{30} isolates is advised by the CLSI as best practice, see Source.}

\item{as_percent}{logical to indicate whether the output must be returned as percent (text), will else be a double}

\item{info}{calculate the amount of available isolates and print it, like \code{n = 423}}

\item{warning}{show a warning when the available amount of isolates is below \code{minimum}}
}
\value{
Double or, when \code{as_percent = TRUE}, a character.
}
\description{
This function is deprecated. Use \code{\link{rsi_IR}} instead.
}
\details{
\strong{Remember that you should filter your table to let it contain only first isolates!} Use \code{\link{first_isolate}} to determine them in your data set.

The functions \code{resistance} and \code{susceptibility} are wrappers around \code{rsi_IR} and \code{rsi_S}, respectively. All functions use hybrid evaluation (i.e. using C++), which makes these functions 20-30 times faster than the old \code{\link{rsi}} function. This latter function is still available for backwards compatibility but is deprecated.
\if{html}{
  \cr\cr
  To calculate the probability (\emph{p}) of susceptibility of one antibiotic, we use this formula:
  \out{<div style="text-align: center">}\figure{mono_therapy.png}\out{</div>}
  To calculate the probability (\emph{p}) of susceptibility of more antibiotics (i.e. combination therapy), we need to check whether one of them has a susceptible result (as numerator) and count all cases where all antibiotics were tested (as denominator). \cr
  \cr
  For two antibiotics:
  \out{<div style="text-align: center">}\figure{combi_therapy_2.png}\out{</div>}
  \cr
  Theoretically for three antibiotics:
  \out{<div style="text-align: center">}\figure{combi_therapy_3.png}\out{</div>}
}
}
\examples{
# Calculate resistance
rsi_R(septic_patients$amox)
rsi_IR(septic_patients$amox)

# Or susceptibility
rsi_S(septic_patients$amox)
rsi_SI(septic_patients$amox)

# Since n_rsi counts available isolates (and is used as denominator),
# you can calculate back to e.g. count resistant isolates:
rsi_IR(septic_patients$amox) * n_rsi(septic_patients$amox)

library(dplyr)
septic_patients \%>\%
  group_by(hospital_id) \%>\%
  summarise(p = rsi_S(cipr),
            n = rsi_n(cipr)) # n_rsi works like n_distinct in dplyr

septic_patients \%>\%
  group_by(hospital_id) \%>\%
  summarise(R = rsi_R(cipr, as_percent = TRUE),
            I = rsi_I(cipr, as_percent = TRUE),
            S = rsi_S(cipr, as_percent = TRUE),
            n = rsi_n(cipr), # also: n_rsi, works like n_distinct in dplyr
            total = n()) # this is the length, NOT the amount of tested isolates

# Calculate co-resistance between amoxicillin/clav acid and gentamicin,
# so we can see that combination therapy does a lot more than mono therapy:
rsi_S(septic_patients$amcl) # S = 67.3\%
rsi_n(septic_patients$amcl) # n = 1570

rsi_S(septic_patients$gent) # S = 74.0\%
rsi_n(septic_patients$gent) # n = 1842

with(septic_patients,
     rsi_S(amcl, gent))     # S = 92.1\%
with(septic_patients,       # n = 1504
     rsi_n(amcl, gent))

septic_patients \%>\%
  group_by(hospital_id) \%>\%
  summarise(cipro_p = rsi_S(cipr, as_percent = TRUE),
            cipro_n = rsi_n(cipr),
            genta_p = rsi_S(gent, as_percent = TRUE),
            genta_n = rsi_n(gent),
            combination_p = rsi_S(cipr, gent, as_percent = TRUE),
            combination_n = rsi_n(cipr, gent))

\dontrun{

# calculate current empiric combination therapy of Helicobacter gastritis:
my_table \%>\%
  filter(first_isolate == TRUE,
         genus == "Helicobacter") \%>\%
  summarise(p = rsi_S(amox, metr),  # amoxicillin with metronidazole
            n = rsi_n(amox, metr))
}
}
